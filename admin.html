<!DOCTYPE html>
<html>
<head>
    <title>Admin - Upload Audio</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>Upload Audio</h2>

<select id="category">
    <option value="Khutbah">Khutbah</option>
    <option value="Darsa Wikiendi">Darsa Wikiendi</option>
    <option value="Darsa Ramadhani">Darsa Ramadhani</option>
</select>

<input type="text" id="title" placeholder="Kichwa cha Mada">
<input type="file" id="audioFile" accept="audio/*">
<button id="uploadBtn">Upload</button>

<script type="module">
import { db, storage } from './firebase.js';
import { collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

document.getElementById("uploadBtn").onclick = async () => {
    const title = document.getElementById("title").value;
    const category = document.getElementById("category").value;
    const file = document.getElementById("audioFile").files[0];

    if (!file || !title) return alert("Jaza kila kitu");

    const storageRef = ref(storage, 'audios/' + file.name);
    await uploadBytes(storageRef, file);

    const url = await getDownloadURL(storageRef);

    await addDoc(collection(db, "audios"), {
        title,
        category,
        url,
        createdAt: new Date()
    });

    alert("Audio imepakiwa kikamilifu!");
};
</script>

</body>
</html>